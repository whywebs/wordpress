function WMP_PAGE_DETAILS(){var t=this;this.type="wmp_pageedit",this.form,this.DOMDoc,this.send_btn,this.init=function(){WMPJSInterface=window.parent.WMPJSInterface,this.send_btn=jQuery("#"+this.type+"_send_btn",this.DOMDoc).get(0),this.form=this.DOMDoc.getElementById(this.type+"_form"),this.addButtonsActions(),null!=this.form&&this.initValidation()},this.initValidation=function(){this.validator=jQuery("#"+this.form.id,this.DOMDoc).validate({rules:{wmp_pageedit_content:{required:!0},messages:{wmp_pageedit_content:{required:"The content is required"}}},errorPlacement:function(e,i){var n=i[0].id.split("_"),o=n.length>1?n[n.length-1]:n[0],r=jQuery("#error_"+o+"_container",t.DOMDoc);e.appendTo(r)},errorElement:"span"})},this.addButtonsActions=function(){jQuery(this.send_btn).unbind("click"),jQuery(this.send_btn).bind("click",function(){t.disableButton(this),t.validate()}),t.enableButton(this.send_btn)},this.enableButton=function(t){jQuery(t).css("cursor","pointer"),jQuery(t).animate({opacity:1},100)},this.disableButton=function(t){jQuery(t).unbind("click"),jQuery(t).animate({opacity:.4},100),jQuery(t).css("cursor","default")},this.scrollToError=function(e){var i=jQuery("html,body",t.DOMDoc),n=parseInt(jQuery("html,body").scrollTop())||parseInt(jQuery("body").scrollTop()),o=i.get(0).clientHeight;parseInt(i.offset().top);n>e?jQuery(i).animate({scrollTop:e-20},1e3):e>n+o&&jQuery(i).animate({scrollTop:n+o},1e3)},this.validate=function(){jQuery(this.form).validate().form();var e=[];for(var i in this.validator.invalid){var n=jQuery(this.form[i]);e.push(n.offset().top)}0==e.length?this.sendData():(e.sort(function(t,e){return t-e}),t.scrollToError(e[0]),t.addButtonsActions())},this.submitForm=function(){return WMPJSInterface.AjaxUpload.dosubmit(t.form,{onStart:t.startUploadingData,onComplete:t.completeUploadingData})},this.sendData=function(){jQuery("#"+this.form.id,this.DOMDoc).unbind("submit"),jQuery("#"+this.form.id,this.DOMDoc).bind("submit",function(){t.submitForm()}),jQuery("#"+this.form.id,this.DOMDoc).submit(),t.disableButton(t.send_btn)},this.startUploadingData=function(){return WMPJSInterface.Preloader.start(),setTimeout(function(){var e=t.form.elements;for(nElems=e.length,j=0;j<nElems;j++)e[j].disabled=!0},300),!0},this.completeUploadingData=function(e){if(jQuery("#"+t.form.id,t.DOMDoc).unbind("submit"),jQuery("#"+t.form.id,t.DOMDoc).bind("submit",function(){return!1}),WMPJSInterface.Preloader.remove(100),e=Number(String(e)),1==e){var i="Your page has been successfully modified!";WMPJSInterface.Loader.display({message:i})}else if(2==e){var i="Please add some content before saving the page. You can deactivate this page if you don't want it to appear in the mobile web app.";WMPJSInterface.Loader.display({message:i})}else{var i="There was an error. Please reload the page and try again.";WMPJSInterface.Loader.display({message:i})}setTimeout(function(){var e=t.form.elements;for(nElems=e.length,j=0;j<nElems;j++)e[j].disabled=!1},300),t.addButtonsActions()}}